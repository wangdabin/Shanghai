#/bin/bash

#业务逻辑输入参数，此处很重要，需要根据实际业务情况认真设定！！！！ 
v_month=$1
v_day=$2

echo "
insert overwrite table ODS.ODS_CDR_OCS_SMS_D partition (month_part = '$v_month',day_part = '$v_day') 
    SELECT 
'$v_month',
'$v_day',
sys_svc_type,
mdn,
call_type,
home_area,
start_time,
opp_party,
opp_number,
sp_code,
sp_smg,
access_code,
service_code,
lang_type,
sv_type,
svc_ex,
msg_type,
msg_length,
stop_cause,
nice,
smg_code,
user_type,
cfee1,
ifee1,
platform_id,
record_no,
smg_in,
smg_out,
israte,
file_type,
file_no,
service_number,
part_id,
acct_id,
sub_id,
svc_type,
region_id,
usage_type,
usage_case,
usage_class,
class_of_srv_code,
cfee,
lfee,
ifee,
mfee,
tfee,
dis_cfee,
dis_lfee,
dis_ifee,
cfee_times,
lfee_times,
ifee_times,
mfee_times,
tfee_times,
cfee_subject,
lfee_subject,
ifee_subject,
mfee_subject,
tfee_subject,
package_id,
product_class,
raw_filename,
late_link,
cal_time,
audi_str,
varian_str,
rerate_cnt,
timestamp,
end_time,
ocs_serial_no,
host_id,
ocs_srv_type,
cust_id,
brand,
raw_host,
balance_info,
bearer_capability,
calling_party,
called_party,
raw_calling_party,
raw_called_party,
balance_value,
exp_date,
total_used,
cash_used,
gift_used,
insert_date
FROM SRC.DR_OCS_SMS
    where 1=1;
"


